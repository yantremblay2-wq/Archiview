<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Grid Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            padding: 1rem;
        }
        .game-container {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            width: 100%;
            max-width: 600px;
            text-align: center;
        }
        .game-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin: 1.5rem auto;
            border: 2px solid #cbd5e0;
            border-radius: 12px;
            padding: 8px;
        }
        .grid-cell {
            width: 100%;
            padding-top: 100%;
            position: relative;
            background-color: #f7fafc;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: 700;
            color: #2d3748;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .grid-cell:hover:not(.occupied):not(.center-cell) {
            background-color: #e2e8f0;
        }
        .occupied {
            cursor: not-allowed;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .occupied.player-1 {
            background-color: #f7fafc;
            color: #2d3748;
        }
        .occupied.player-2 {
            background-color: #2d3748;
            color: #ffffff;
        }
        .center-cell {
            background-color: #e2e8f0;
            cursor: not-allowed;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: #a0aec0;
            position: relative;
        }
        .center-cell::after {
            content: 'x';
        }
        .player-info {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        .player-card {
            background-color: #e2e8f0;
            padding: 1rem;
            border-radius: 12px;
            width: 45%;
            min-width: 150px;
            margin-top: 1rem;
        }
        .player-card.active {
            box-shadow: 0 0 0 3px #63b3ed;
            background-color: #ebf8ff;
        }
        .number-selector {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        .number-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s ease, background-color 0.2s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background-color: #63b3ed;
            color: white;
        }
        .number-btn.selected {
            background-color: #4299e1;
            transform: scale(1.1);
        }
        .number-btn:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
        }
        #message-box {
            background-color: #fff;
            padding: 1rem;
            border-radius: 12px;
            text-align: center;
            font-weight: 700;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="text-3xl font-bold mb-4">5x5 Number Grid</h1>
        <p id="status" class="text-xl font-semibold mb-4 text-gray-700">Player 1's turn</p>

        <div class="player-info">
            <div id="player-1-card" class="player-card active">
                <h3 class="text-lg font-bold">Player 1</h3>
                <p>1s: <span id="p1-1s">4</span> | 2s: <span id="p1-2s">4</span> | 3s: <span id="p1-3s">4</span></p>
                <p>Score: <span id="p1-score">0</span></p>
            </div>
            <div id="player-2-card" class="player-card">
                <h3 class="text-lg font-bold">Player 2</h3>
                <p>1s: <span id="p2-1s">4</span> | 2s: <span id="p2-2s">4</span> | 3s: <span id="p2-3s">4</span></p>
                <p>Score: <span id="p2-score">0</span></p>
            </div>
        </div>

        <div class="number-selector">
            <button class="number-btn" data-value="1">1</button>
            <button class="number-btn" data-value="2">2</button>
            <button class="number-btn" data-value="3">3</button>
        </div>

        <div id="game-grid" class="game-grid"></div>
        
        <div id="message-box" class="hidden"></div>
    </div>

    <script>
        // Game state variables
        let currentPlayer = 1;
        let selectedNumber = null;
        let board = Array(25).fill(null);
        const gridSize = 5;
        const centerIndex = Math.floor(board.length / 2);
        let players = {
            1: {
                numbers: { '1': 4, '2': 4, '3': 4 },
                score: 0
            },
            2: {
                numbers: { '1': 4, '2': 4, '3': 4 },
                score: 0
            }
        };

        // DOM elements
        const statusEl = document.getElementById('status');
        const gridEl = document.getElementById('game-grid');
        const numberButtons = document.querySelectorAll('.number-btn');
        const player1Card = document.getElementById('player-1-card');
        const player2Card = document.getElementById('player-2-card');
        const messageBox = document.getElementById('message-box');

        // Initial rendering on page load
        window.onload = function() {
            renderGrid();
            updateUI();

            // Event Listeners
            numberButtons.forEach(button => {
                button.addEventListener('click', () => selectNumber(button.dataset.value));
            });
        };

        // Functions
        function renderGrid() {
            gridEl.innerHTML = '';
            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.classList.add('grid-cell');
                cell.dataset.index = i;
                
                if (i === centerIndex) {
                    cell.classList.add('center-cell');
                } else if (board[i] !== null) {
                    cell.classList.add('occupied', `player-${board[i].player}`);
                    cell.textContent = board[i].value;
                } else {
                    cell.addEventListener('click', handleCellClick);
                }
                gridEl.appendChild(cell);
            }
        }

        function updateUI() {
            statusEl.textContent = `Player ${currentPlayer}'s turn`;
            document.getElementById(`p1-1s`).textContent = players[1].numbers['1'];
            document.getElementById(`p1-2s`).textContent = players[1].numbers['2'];
            document.getElementById(`p1-3s`).textContent = players[1].numbers['3'];
            document.getElementById(`p2-1s`).textContent = players[2].numbers['1'];
            document.getElementById(`p2-2s`).textContent = players[2].numbers['2'];
            document.getElementById(`p2-3s`).textContent = players[2].numbers['3'];
            document.getElementById(`p1-score`).textContent = players[1].score;
            document.getElementById(`p2-score`).textContent = players[2].score;

            if (currentPlayer === 1) {
                player1Card.classList.add('active');
                player2Card.classList.remove('active');
            } else {
                player2Card.classList.add('active');
                player1Card.classList.remove('active');
            }

            numberButtons.forEach(btn => {
                const num = btn.dataset.value;
                btn.disabled = players[currentPlayer].numbers[num] === 0;
                btn.classList.remove('selected');
                if (num === selectedNumber) {
                    btn.classList.add('selected');
                }
            });
        }

        function selectNumber(value) {
            selectedNumber = value;
            updateUI();
        }

        function calculateScores() {
            // Reset scores
            players[1].score = 0;
            players[2].score = 0;

            for (let i = 0; i < 25; i++) {
                const cell = board[i];
                if (cell !== null) {
                    const row = Math.floor(i / gridSize);
                    const col = i % gridSize;
                    let tileScore = 0;

                    const neighbors = [
                        { r: row - 1, c: col }, // top
                        { r: row + 1, c: col }, // bottom
                        { r: row, c: col - 1 }, // left
                        { r: row, c: col + 1 }  // right
                    ];

                    neighbors.forEach(neighbor => {
                        if (neighbor.r >= 0 && neighbor.r < gridSize && neighbor.c >= 0 && neighbor.c < gridSize) {
                            const neighborIndex = neighbor.r * gridSize + neighbor.c;
                            const neighborValue = board[neighborIndex] ? board[neighborIndex].value : 0;
                            tileScore += Math.max(0, cell.value - neighborValue);
                        } else {
                            // Neighbor is outside the grid, treat as 0
                            tileScore += Math.max(0, cell.value - 0);
                        }
                    });

                    players[cell.player].score += tileScore;
                }
            }
        }

        function handleCellClick(event) {
            const cellIndex = event.target.dataset.index;
            if (cellIndex == centerIndex) {
                return;
            }

            if (selectedNumber === null) {
                showMessage("Please select a number first.");
                return;
            }

            if (board[cellIndex] === null) {
                // Place the number
                board[cellIndex] = { value: parseInt(selectedNumber), player: currentPlayer };
                players[currentPlayer].numbers[selectedNumber]--;

                // Recalculate scores for both players
                calculateScores();

                // Switch player
                currentPlayer = currentPlayer === 1 ? 2 : 1;
                selectedNumber = null;
                
                // Re-render and update UI
                renderGrid();
                updateUI();
                checkGameOver();
            }
        }

        function checkGameOver() {
            const occupiedCells = board.filter(cell => cell !== null).length;
            if (occupiedCells === 24) {
                const p1Score = players[1].score;
                const p2Score = players[2].score;
                let winnerMessage = "";
                if (p1Score > p2Score) {
                    winnerMessage = `Game Over! Player 1 wins with a score of ${p1Score}!`;
                } else if (p2Score > p1Score) {
                    winnerMessage = `Game Over! Player 2 wins with a score of ${p2Score}!`;
                } else {
                    winnerMessage = `Game Over! It's a tie with a score of ${p1Score}!`;
                }
                showMessage(winnerMessage);
            }
        }
        
        function showMessage(text) {
            messageBox.textContent = text;
            messageBox.classList.remove('hidden');
            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000);
        }

    </script>
</body>
</html>
